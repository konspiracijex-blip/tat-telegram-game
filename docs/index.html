
<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAT IGRA - Test</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <h1>Tematski Appercepcioni Test</h1>
        <div id="pitanje-broj">Pitanje 1 / 10</div>
        
        <div class="slika-kontejner">
            <img id="slika" src="placeholder/slika_01.jpg" alt="Slika za TAT test">
        </div>
        
        <p id="pitanje-tekst">Šta vidite na ovoj slici? (Privremeni tekst)</p>
        
        <div id="odgovori-kontejner">
            <button class="odgovor-btn" data-odgovor="A">A: Odgovor A</button>
            <button class="odgovor-btn" data-odgovor="B">B: Odgovor B</button>
            <button class="odgovor-btn" data-odgovor="C">C: Odgovor C</button>
            <button class="odgovor-btn" data-odgovor="D">D: Odgovor D</button>
        </div>
        <div id="status"></div>
    </div>

    <script>
        // --- JS LOGIKA ZA SLANJE ODGOVORA BOTU ---

        let trenutnoPitanje = 1;
        const ukupanBrojPitanja = 10;
        
        // PAZNJA: U realnom scenariju, Bot bi poslao listu pitanja,
        // ali za MVP koristimo hardkodovane placeholder vrednosti
        const pitanja = [
            // Koristite placeholder vrednosti iz data_logic.py za testiranje frontend-a
            {q: 1, slika: 'placeholder/slika_01.jpg', tekst: 'Šta vidite kada pogledate ovu staru kuću?', odgovori: {A: 'Napušteno, ali puno uspomena.', B: 'Prazan, propadajući objekat.', C: 'Mesto koje čeka novu priču.', D: 'Samo prolaznost vremena.'}},
            {q: 2, slika: 'placeholder/slika_02.jpg', tekst: 'Ova planina Vas podseća na:', odgovori: {A: 'Prepreku koju treba zaobići.', B: 'Izazov koji treba savladati.', C: 'Miran, stabilan oslonac.', D: 'Simbol večnosti.'}},
            // ... dodajte 8 ostalih placeholder pitanja za testiranje
            {q: 10, slika: 'placeholder/slika_10.jpg', tekst: 'Ovaj osmeh Vas navodi da mislite da je osoba:', odgovori: {A: 'Srećna, bez sumnje.', B: 'Nešto krije.', C: 'Pokušava da Vas impresionira.', D: 'Zadovoljna sobom.'}},
        ];
        
        // Inicijalizacija Telegram WebApp
        if (window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.MainButton.hide(); 
        } 
        
        function ucitajPitanje(index) {
            if (index > ukupanBrojPitanja) {
                document.getElementById('odgovori-kontejner').innerHTML = "<h2>Hvala! Vaša procena je generisana. Proverite Telegram chat.</h2>";
                document.getElementById('pitanje-broj').innerText = "Igra završena";
                document.getElementById('pitanje-tekst').style.display = 'none';
                document.getElementById('slika').style.display = 'none';
                setTimeout(() => {
                     window.Telegram.WebApp.close(); 
                }, 2000);
                return;
            }
            
            const pitanjeData = pitanja[index - 1]; // Niz je 0-indeksiran
            
            document.getElementById('pitanje-broj').innerText = `Pitanje ${index} / ${ukupanBrobanBrojPitanja}`;
            document.getElementById('slika').src = pitanjeData.slika;
            document.getElementById('pitanje-tekst').innerText = pitanjeData.tekst;
            
            const odgovoriKontejner = document.getElementById('odgovori-kontejner');
            odgovoriKontejner.innerHTML = ''; 
            
            for (const [key, value] of Object.entries(pitanjeData.odgovori)) {
                const btn = document.createElement('button');
                btn.className = 'odgovor-btn';
                btn.setAttribute('data-odgovor', key);
                btn.innerText = `${key}: ${value}`;
                btn.addEventListener('click', handleOdgovorClick);
                odgovoriKontejner.appendChild(btn);
            }
        }

        function handleOdgovorClick() {
            const odgovor = this.getAttribute('data-odgovor');
            
            sendAnswerToBot(trenutnoPitanje, odgovor);
            
            trenutnoPitanje++;
            ucitajPitanje(trenutnoPitanje);
        }

        function sendAnswerToBot(pitanje, odgovor) {
            if (window.Telegram.WebApp) {
                const dataToSend = JSON.stringify({
                    pitanje: pitanje,
                    odgovor: odgovor
                });
                window.Telegram.WebApp.sendData(dataToSend);
            } else {
                 document.getElementById('status').innerText = `Poslat odgovor (offline test): P${pitanje}, O:${odgovor}`;
            }
        }
        
        window.onload = () => ucitajPitanje(trenutnoPitanje);
    </script>
</body>
</html>
